!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self)["json-convert"]=t()}(this,function(){"use strict";var t=["string","number","boolean","null","object","array"],i=function(e){return null===e?null:-1!==t.indexOf(typeof e)?typeof e:"string"},b=function(e){return h(e)&&-1!==t.indexOf(e.type)},h=function(e){return null!==e&&!v(e)&&"object"==typeof e},o=function(e){return"function"==typeof e},v=function(e){return Array.isArray(e)},s=function(e){return v(e)&&0===e.length},d=function(e){return h(e)&&s(Object.keys(e))},g=function(e,t){for(var r in e)if(e[r]===t)return!0;return!1},y=function(e,t){return h(e)&&e.hasOwnProperty(t)},O=function(e,t){for(var r in e)e.hasOwnProperty(r)&&t.call(e,e[r],r,e)},x=function(e){return!(!h(e)||!h(e.properties)||"object"!==e.type)},j=function(e){return!(!h(e)||!h(e.items)||"array"!==e.type)},P=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=e[r]&&"[object Object]"===e[r].toString()?P(e[r],t[r]):e[r]=t[r]);return e};function q(e,m){m=P({title:"",description:"",requiredSign:"*",aliasSign:"@",allRequired:!1},m);function d(e,t){if(void 0!==e)return t=t||{},v(e)?r(e,t):h(e)?n(e,t):t.type=i(e),t}var r=function(e,t){t.type="array";t=t.items={};e.length&&d(e[0],t)},n=function(e,t){if(b(e))return P(n=t,r=e),"object"===n.type&&(delete n.properties,r.properties&&d(r.properties,n)),void("array"===n.type&&(delete n.items,n.items={},r.items&&d(r.items,n.items)));var r,n,i,u,o,s,a,f,c,p,l;for(i in t.type="object",t.required=[],t.properties={},e)e.hasOwnProperty(i)&&(o=e[u=i],s=t.properties[u]={},a=m.aliasSign,l=m.requiredSign,f=m.allRequired,c="",-1!==(p=u.indexOf(a))&&(delete t.properties[u],c=u.substr(p+a.length),u=u.substr(0,p),s=t.properties[u]={}),(l=u[0]===l)&&(delete t.properties[u],u=u.substr(1),s=t.properties[u]={},t.required.push(u)),f&&(l||t.required.push(u)),c&&(s.alias=c),s.name=u,y(s),d(o,s))},y=function(e){for(var t in e)e.hasOwnProperty(t)&&(g(e.attributes,t)||(e["@"+t]=e[t],delete e[t]));return e},t=Object.assign({title:m.title,description:m.description},q.baseSchema);return Object.assign(t,d(e))}function n(e,t,i){i=P({defaults:{string:"",number:0,boolean:!1,null:null},filters:{string:function(e){return g([void 0,null],e)?"":String(e)},number:function(e){return g([void 0,null,""],e)?0:Number(e)},boolean:function(e){return!g(["0",""],e)&&Boolean(e)},null:function(e){return null===e?e:null},array:function(e){return v(e)?e:[]},object:function(e){return h(e)?e:{}}},redundancy:!1},i);function a(e){return q.getAttribute(e,"alias")||q.getAttribute(e,"name")}var r,n,u=new S,f=function(e,t){var r,n=a(t);for(r in t.enums){var i=t.enums[r];if(i.name===e[n])return void(e[n]=i.value)}},c=function(e,t){var r=e[a(t)],n=q.getAttribute(t,"filter")||i.filters[t.type];return o(n)?n.call(u,r,e,t):r},p=function(e){if(y(e,"default"))return e.default;var t=i.defaults;if(t.hasOwnProperty(e.type))return t[e.type];if(j(e))return[];if(x(e)){if(d(e.properties))return{};var r={};return O(e.properties,function(e,t){r[t]=p(e)}),r}},l=function(u,o){if(u=h(u)?u:{},!x(o))return u;if(d(o.properties))return u;var t,s={};return O(o.properties,function(e,t){var r,n,i=a(e);y(u,i)?(r=u,i=a(n=e),n=y(r,i)?(v(n.enums)&&f(r,n),c(r,n)):p(n),x(e)?s[t]=l(n,e):j(e)?s[t]=m(n,e):s[t]=n):g(o.required,t)&&(s[t]=p(e))}),i.redundancy&&(t=JSON.parse(JSON.stringify(u)),O(o.properties,function(e){e=a(e);y(u,e)&&delete t[e]}),P(s,t)),s},m=function(e,t){if(e=v(e)?e:[],!j(t))return e;return s(e)?[]:x(t.items)?e.map(function(e){return l(e,t.items)}):e};return r=e,d(n=t)?r:(b(n)||(n=q(n)),x(n)?l(r,n):j(n)?m(r,n):void 0)}function S(e,t,r){return this?{convert:n,schema:q}:n(e,t,r)}return q.baseSchema={id:"http://json-schema.org/draft-04/schema#",$schema:"http://json-schema.org/draft-04/schema#",title:"",description:""},q.setAttribute=function(e,t,r){return g(this.attributes,t)?e[t]=r:e["@"+t]=r,e},q.getAttribute=function(e,t){return g(this.attributes,t)?e[t]:e["@"+t]},q.attributes=["$schema","title","description","type","properties","required","minimum","exclusiveMinimum","maximum","exclusiveMaximum","multipleOf","maxLength","minLength","pattern","maxProperties","minProperties","additionalProperties","items","minItems","maxItem","uniqueItems","additionalProperties","Dependencies","patternProperties","maxLength","minLength","pattern","format","minimum","exclusiveMinimum","maximum","exclusiveMaximum","multipleOf","$ref","definitions","allOf","anyOf","oneOf","not","default"],S.version="1.1.0",S.schema=q,S.convert=n,S});
